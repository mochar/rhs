:PROPERTIES:
:header-args: :async yes :session rhsp
:END:

#+begin_src jupyter-python
import importlib

import jax
import matplotlib.pyplot as plt

import rhs
importlib.reload(rhs)

jax.config.update('jax_platform_name', 'cpu')

dataset = rhs.datasets.TestDataset()
model = rhs.ModelSimple(dataset.X, dataset.Y, tau_scale=0.01, c_df=5., c_scale=1.)
trainer = rhs.Trainer(model)
#+end_src

#+RESULTS:

asd

#+begin_src jupyter-python
trainer.train(1000)
plt.plot(trainer.losses)
trainer.save('/tmp/model.pkl')
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/2b879d06cebb66a7f692700d530c65480219ab23.png]]

asd

#+begin_src jupyter-python
dataset.plot_coeffs(trainer)
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/0945923ac401149b1297ed5be17544c2904dbdff.png]]

